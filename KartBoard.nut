//
// Bundle file
// Code changes will be overwritten
//

// title:   Mario Kart Super Board
// author:  Adrian Azan
// desc:    Small board game template
// site:    adrian-azan.com
// license: MIT License
// version: 0.1
// script:  squirrel


/*###################################
#                                   #
#   GLOBALS                         #
#                                   #
###################################*/
local BCKGRND = 11
local BRDCOLR = 13
local MINCOLR = 1

local STATE = 0
local CONTROLLER = null
local GAME = null


local racerNames = array(6)
racerNames[0] = ["MAR","LUI","PEA","DAI",
            "ROS","TAR","TEA"]
racerNames[1] = ["YOS","TOA","KOO","SHY",
            "LAK","TDE","BOO"]
racerNames[2] = ["BAR","BUI","BEA","BAI",
            "BOS","MMA","MPE"]
racerNames[3] = ["WAR","WAL","DON","BOW",
            "DRY","BJR","DBO"]
racerNames[4] = ["LEM","LAR","WEN","LUD",
            "IGG","ROY","MOR"]
racerNames[5] = ["SQG","SQB","LNK","VIB",
            "VIG","ISA","MII"]



/*###################################
#                                   #
#   FUNCTIONS                       #
#                                   #
###################################*/
function clamp(x,min,max)
{
    if (x < min)
        return min
    if (x >= max)
        return min
    return x
}

include("Clickable.Clickable")
include("Clickable.Letter")
include("Clickable.Player")
include("Clickable.Tile")

include("Buttons.Button")
include("Buttons.AddPlayer")
include("Buttons.Randomize")
include("Buttons.Digit")

include("Boards.Grid")
include("Boards.LetterBoard")
include("Boards.PlayerBoard")
include("Boards.RacerBoard")
include("Boards.Confirmation")


class Game
{
    players = null
    letters = null
    board = null
    focus = null
    randomSeed = null
    constructor()
    {
        players = PlayerBoard()
        letters = LetterBoard()
        board = RacerBoard()
        randomSeed = Confirmation()

        focus = randomSeed
        players.Push()
    }

    function Draw()
    {
        if (STATE == 0)
        {
            players.CalcPoints(board)
            players.Draw(true)
            board.Draw(board == focus)
        }

        if (STATE == 1)
        {
            letters.Draw()
        }

        if (STATE == 2)
        {
            focus = randomSeed
            randomSeed.Draw()
        }
    }

    function UPDATE()
    {
        if (btnp(0,30,15))
            focus.Asc()

        if (btnp(1,30,15))
            focus.Des()


        if (btnp(2,30,15))
            focus.Prev()

        if (btnp(3,30,15))
            focus.Next()

        if (btnp(4))
            focus.A(board,players)

        if (btnp(5))
            focus.B()

        if (btnp(7))
            focus.Y(this)

        if (btn(6) && STATE == 0)
            focus = board

        else if (!btn(6) && STATE == 0)
            focus = players
    }
}



GAME = Game()

function TIC()
{
    cls(BCKGRND)

    GAME.UPDATE()
    GAME.Draw()

}




// <TILES>
// 000:ffffffffffffffffff000000ff000006ff000006ff000006ff000006ff066666
// 001:ffffffffffffffff000000ff600000ff600000ff600000ff600000ff666660ff
// 002:ffffffffffffffffff000000ff000000ff660000ff006000ff000600ff000066
// 003:ffffffffffffffff000600ff000060ff006666ff060060ff600600ff000000ff
// 016:ff066666ff000006ff000006ff000006ff000006ff000000ffffffffffffffff
// 017:666660ff600000ff600000ff600000ff600000ff000000ffffffffffffffffff
// 018:ff000066ff000600ff006000ff660000ff000000ff000000ffffffffffffffff
// 019:000000ff600600ff060060ff006666ff000060ff000600ffffffffffffffffff
// 032:eeeeeeeeeeeeeeeeee000000ee000006ee000006ee000006ee000006ee066666
// 033:eeeeeeeeeeeeeeee000000ee600000ee600000ee600000ee600000ee666660ee
// 034:eeeeeeeeeeeeeeeeee000000ee000000ee660000ee006000ee000600ee000066
// 035:eeeeeeeeeeeeeeee000600ee000060ee006666ee060060ee600600ee000000ee
// 048:ee066666ee000006ee000006ee000006ee000006ee000000eeeeeeeeeeeeeeee
// 049:666660ee600000ee600000ee600000ee600000ee000000eeeeeeeeeeeeeeeeee
// 050:ee000066ee000600ee006000ee660000ee000000ee000000eeeeeeeeeeeeeeee
// 051:000000ee600600ee060060ee006666ee000060ee000600eeeeeeeeeeeeeeeeee
// 064:fffffffff0000000f0040404f0044404f0004004f0004004f0004004ffffffff
// 065:ffffffff0000000f4044400f0040000f4044400f0000400f4044400fffffffff
// 066:fffffffff0000000f0044440f0040040f0040040f0040040f0040040ffffffff
// 067:ffffffff0000000f0444400f0400400f0400400f0400400f0444400fffffffff
// 080:eeeeeeeee0000000e0040404e0044404e0004004e0004004e0004004eeeeeeee
// 081:eeeeeeee0000000e4044400e0040000e4044400e0000400e4044400eeeeeeeee
// 082:eeeeeeeee0000000e0044440e0040040e0040040e0040040e0040040eeeeeeee
// 083:eeeeeeee0000000e0444400e0400400e0400400e0400400e0444400eeeeeeeee
// </TILES>

// <MAP>
// 001:000000000000000000000000000000000000000000404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
// 002:000000000000000000000000000000000040404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
// 003:000000000000000000000000000000004040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
// 004:000000000000000000000000000000404000004040404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
// 005:000000000000000000000000000000404000404000004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
// 006:000000000000000000000000000000004040404040404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
// 007:000000000000000000000000000000000040404040404040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
// </MAP>

// <PALETTE>
// 000:16171a7f0622d62411ff8426ffd100fafdffff80a4ff267494216a43006723497568aed4bfff3c10d275007899002859
// </PALETTE>

